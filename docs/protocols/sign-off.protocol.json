{
  "name": "daily-sign-off",
  "version": "1.0.0",
  "description": "Daily work session end protocol",
  "triggers": ["manual", "scheduled:00:00-AEST"],
  "validations": [
    {
      "type": "active-session-check",
      "description": "Verify there is an active work session to sign off",
      "required": true,
      "action_on_fail": "error-no-active-session"
    },
    {
      "type": "minimum-session-time",
      "description": "Ensure minimum 30 minutes session time",
      "threshold": 30,
      "required": false,
      "action_on_fail": "log-warning"
    }
  ],
  "interactive_prompts": [
    {
      "id": "accomplishments",
      "question": "What was accomplished in this session?",
      "type": "multiline",
      "required": true,
      "placeholder": "List major tasks completed, progress made, or problems solved..."
    },
    {
      "id": "blockers",
      "question": "Any blockers or issues encountered?",
      "type": "multiline",
      "required": false,
      "placeholder": "Technical issues, missing requirements, external dependencies..."
    },
    {
      "id": "next-priorities",
      "question": "Priority tasks for the next session?",
      "type": "multiline",
      "required": true,
      "placeholder": "What should be tackled next? Any urgent items?"
    },
    {
      "id": "rd-activities",
      "question": "R&D activities performed (for tax compliance)?",
      "type": "checklist",
      "options": [
        "AI/ML algorithm development",
        "Healthcare data processing research",
        "Security compliance implementation",
        "Novel architecture design",
        "Technical problem solving",
        "Performance optimization research",
        "Other research and development"
      ],
      "required": true
    }
  ],
  "actions": [
    {
      "id": "session-end",
      "type": "time-track",
      "action": "end-session",
      "timestamp": "auto",
      "metadata": {
        "accomplishments": "from-prompt:accomplishments",
        "blockers": "from-prompt:blockers",
        "rd_activities": "from-prompt:rd-activities"
      }
    },
    {
      "id": "progress-log-summary",
      "type": "file-update",
      "target": "docs/PROGRESS_LOG.md",
      "action": "append",
      "template": "session-summary",
      "data": {
        "timestamp": "auto",
        "session_id": "from-session",
        "duration": "calculated",
        "accomplishments": "from-prompt:accomplishments",
        "blockers": "from-prompt:blockers",
        "next_steps": "from-prompt:next-priorities"
      }
    },
    {
      "id": "tasks-update",
      "type": "file-update",
      "target": "docs/management/TASKS.md",
      "action": "smart-update",
      "logic": {
        "mark_completed": "from-accomplishments",
        "add_new_tasks": "from-next-priorities",
        "update_priorities": "from-user-input"
      }
    },
    {
      "id": "session-summary-create",
      "type": "file-create",
      "target": "docs/sessions/YYYY-MM-DD-session.md",
      "template": "daily-session-summary",
      "data": {
        "date": "auto",
        "session_data": "from-time-tracker",
        "user_input": "from-prompts"
      }
    },
    {
      "id": "notion-progress-update",
      "type": "notion-sync",
      "target": "progress-tracker",
      "action": "update-daily-entry",
      "data": {
        "session_end": "auto",
        "duration": "calculated",
        "accomplishments": "from-prompt:accomplishments",
        "blockers": "from-prompt:blockers",
        "rd_hours": "calculated",
        "status": "completed"
      }
    },
    {
      "id": "time-summary-update",
      "type": "notion-sync",
      "target": "time-tracking",
      "action": "log-session",
      "data": {
        "session_data": "complete",
        "rd_eligible": "calculated",
        "activities": "from-prompt:rd-activities"
      }
    },
    {
      "id": "generate-weekly-report",
      "type": "conditional-action",
      "condition": "end-of-week",
      "action": "generate-report",
      "target": "weekly-summary",
      "include": ["time-summary", "accomplishments-summary", "rd-compliance"]
    },
    {
      "id": "backup-session-data",
      "type": "file-backup",
      "targets": [
        "protocols/time-tracker.json",
        "docs/PROGRESS_LOG.md",
        "docs/management/TASKS.md"
      ],
      "destination": "backups/YYYY-MM-DD/"
    },
    {
      "id": "completion-message",
      "type": "display",
      "message": "âœ… Work session signed off successfully! Session duration: {duration}. Great work today!",
      "include_data": [
        "session_duration",
        "accomplishments_count",
        "rd_hours_today",
        "total_hours_this_week"
      ]
    }
  ],
  "error_handling": {
    "strategy": "retry-critical-save-all",
    "critical_actions": ["session-end", "progress-log-summary", "backup-session-data"],
    "retry_attempts": 3,
    "log_file": "protocols/logs/sign-off-errors.log"
  },
  "success_criteria": {
    "required_completions": ["session-end", "progress-log-summary", "backup-session-data"],
    "optional_completions": ["notion-progress-update", "time-summary-update"]
  },
  "post_execution": {
    "cleanup": ["temp-files"],
    "notifications": ["session-complete"],
    "next_session_prep": ["validate-readiness"]
  }
}