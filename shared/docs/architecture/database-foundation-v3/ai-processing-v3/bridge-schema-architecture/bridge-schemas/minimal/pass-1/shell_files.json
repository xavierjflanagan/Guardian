{
  "table": "shell_files",
  "pass": "pass-1",
  "operation": "CREATE",
  "required": ["patient_id", "filename", "original_filename", "file_size_bytes", "mime_type", "storage_path"],
  "fields": {
    "patient_id": "uuid (context)",
    "filename": "string",
    "original_filename": "string",
    "file_size_bytes": "bigint",
    "mime_type": "string",
    "storage_path": "string",
    "status": "uploaded|processing|completed|failed|archived (default: uploaded)",
    "processing_started_at": "timestamptz?",
    "processing_completed_at": "timestamptz?",
    "processing_error": "jsonb?",
    "file_type": "medical_record|lab_result|imaging_report|prescription|discharge_summary|referral|insurance_card|id_document|other?",
    "file_subtype": "string?",
    "confidence_score": "numeric(3,2)?",
    "extracted_text": "string?",
    "ocr_confidence": "numeric(3,2)?",
    "page_count": "integer? (default: 1)",
    "processing_job_id": "uuid?",
    "processing_worker_id": "string? (max 100)",
    "processing_priority": "integer? (default: 100)",
    "idempotency_key": "string? (unique)",
    "processing_cost_estimate": "decimal(10,4)? (default: 0)",
    "processing_duration_seconds": "integer?",
    "language_detected": "string? (default: en)",
    "provider_name": "string?",
    "facility_name": "string?",
    "upload_context": "string?",
    "processed_image_path": "string? (Phase 2, CHECK 1-2048 chars)",
    "processed_image_checksum": "string? (Phase 2, SHA256)",
    "processed_image_mime": "string? (Phase 2)",
    "ai_synthesized_summary": "null (Pass 3 only)",
    "narrative_count": "0 (Pass 3 only)",
    "synthesis_completed_at": "null (Pass 3 only)"
  },
  "pass1_creates": "File metadata, processing status, OCR results, entity detection metadata",
  "pass3_updates": "ai_synthesized_summary, narrative_count, synthesis_completed_at",
  "example": {
    "patient_id": "uuid-from-context",
    "filename": "medical_record_20250101_123456.pdf",
    "original_filename": "Dr_Smith_Visit_2025.pdf",
    "file_size_bytes": 2458624,
    "mime_type": "application/pdf",
    "storage_path": "medical-docs/patient-uuid/medical_record_20250101_123456.pdf",
    "status": "processing",
    "processing_started_at": "2025-01-01T12:34:56Z",
    "file_type": "medical_record",
    "file_subtype": "general_practitioner_visit",
    "confidence_score": 0.92,
    "extracted_text": "[Full OCR text...]",
    "ocr_confidence": 0.88,
    "page_count": 4,
    "processing_job_id": "uuid-of-job",
    "processing_worker_id": "worker-01",
    "language_detected": "en",
    "provider_name": "Dr. Jane Smith",
    "facility_name": "Sydney Medical Centre",
    "ai_synthesized_summary": null,
    "narrative_count": 0,
    "synthesis_completed_at": null
  }
}
