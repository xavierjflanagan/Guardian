{
  "table": "entity_processing_audit",
  "pass": "pass-1",
  "operation": "CREATE",
  "required": ["shell_file_id", "patient_id", "processing_session_id", "entity_id", "original_text", "entity_category", "entity_subtype", "pass1_confidence", "requires_schemas", "processing_priority", "pass1_model_used", "pass1_vision_processing"],
  "fields": {
    "shell_file_id": "uuid (context)",
    "patient_id": "uuid (context)",
    "processing_session_id": "uuid (context)",
    "entity_id": "string (unique, e.g., entity_001)",
    "original_text": "string (exact text from document)",
    "entity_category": "clinical_event|healthcare_context|document_structure",
    "entity_subtype": "string (vital_sign, medication, diagnosis, section_header, etc.)",
    "unique_marker": "string? (searchable pattern)",
    "location_context": "string? (e.g., 'Page 1, vitals section')",
    "spatial_bbox": "jsonb? ({x, y, width, height, page})",
    "page_number": "integer?",
    "pass1_confidence": "numeric(4,3) 0.000-1.000",
    "requires_schemas": "text[] (tables for Pass 2, empty for document_structure)",
    "processing_priority": "highest|high|medium|low|logging_only",
    "pass2_status": "pending|skipped (default: pending)",
    "pass1_model_used": "string (gpt-4o-mini, claude-3-5-sonnet)",
    "pass1_vision_processing": "boolean",
    "pass1_token_usage": "integer?",
    "pass1_image_tokens": "integer?",
    "pass1_cost_estimate": "numeric(8,4)?",
    "ai_visual_interpretation": "string?",
    "visual_formatting_context": "string?",
    "ai_visual_confidence": "numeric(4,3)? 0.000-1.000",
    "ocr_reference_text": "string?",
    "ocr_confidence": "numeric(4,3)? 0.000-1.000",
    "ocr_provider": "string? (google_vision, aws_textract)",
    "ai_ocr_agreement_score": "numeric(4,3)? 0.0-1.0",
    "spatial_mapping_source": "ocr_exact|ocr_approximate|ai_estimated|none?",
    "discrepancy_type": "string?",
    "discrepancy_notes": "string?",
    "visual_quality_assessment": "string?",
    "validation_flags": "text[]? (default: {})",
    "cross_validation_score": "numeric(4,3)? 0.000-1.000",
    "manual_review_required": "boolean? (default: false)",
    "profile_verification_confidence": "numeric(4,3)? 0.000-1.000",
    "pii_sensitivity_level": "none|low|medium|high?",
    "compliance_flags": "text[]? (default: {})"
  },
  "pass2_fields_null": ["pass2_confidence", "pass2_started_at", "pass2_completed_at", "enrichment_errors", "pass2_model_used", "pass2_token_usage", "pass2_cost_estimate", "final_event_id", "final_encounter_id", "final_observation_id", "final_intervention_id", "final_condition_id", "final_allergy_id", "final_vital_id", "manual_review_completed", "manual_review_notes", "manual_reviewer_id"],
  "example": {
    "shell_file_id": "uuid-of-shell-file",
    "patient_id": "uuid-of-patient",
    "processing_session_id": "uuid-of-session",
    "entity_id": "entity_001",
    "original_text": "BP: 120/80 mmHg",
    "entity_category": "clinical_event",
    "entity_subtype": "vital_sign_blood_pressure",
    "location_context": "Page 1, vitals section",
    "page_number": 1,
    "pass1_confidence": 0.980,
    "requires_schemas": ["patient_observations", "patient_vitals"],
    "processing_priority": "highest",
    "pass2_status": "pending",
    "pass1_model_used": "gpt-4o-mini",
    "pass1_vision_processing": true,
    "pass1_cost_estimate": 0.0045,
    "ai_visual_confidence": 0.985,
    "ocr_confidence": 0.990,
    "ai_ocr_agreement_score": 1.0,
    "cross_validation_score": 0.990,
    "pii_sensitivity_level": "medium"
  }
}
